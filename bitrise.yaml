format_version: "11"
default_step_lib_source: "https://github.com/bitrise-io/bitrise-steplib.git"

project_type: android

workflows:
  build_apk:
    summary: Build and package your Android app from GitHub using HTTPS clone.
    steps:
      - git-clone@8:
          inputs:
            repository_url: "https://github.com/onewempye00-png/My-Editor-App-0.1.git"
            branch: "main"
            fetch_tags: "true"
            update_submodules: "true"

      - install-missing-android-tools@3:
          inputs:
            gradlew_path: "./gradlew"

      - android-build@1:
          inputs:
            project_location: "."
            module: "app"
            variant: "release"
            build_type: "apk"

      - sign-apk@1:
          run_if: "{{getenv \"BITRISEIO_ANDROID_KEYSTORE_URL\" | ne \"\"}}"
          inputs:
            use_apk_signer: true
            android_app: "$BITRISE_APK_PATH"

      - deploy-to-bitrise-io@2:
          inputs:
            notify_user_groups: "none"
            notify_email_list: "onewempye00@gmail.com"
            artifact_type: "apk"

meta:
  bitrise.io:
    stack: linux-docker-android-22.04
    machine_type: standard

envs:
  - BITRISE_DONT_USE_SSH: "true"
  - GRADLE_OPTS: "-Dorg.gradle.daemon=false -Dorg.gradle.jvmargs=-Xmx2048m"
  - JAVA_HOME: "/usr/lib/jvm/java-17-openjdk-amd64"
  - ANDROID_SDK_ROOT: "/opt/android-sdk"
  - ANDROID_HOME: "/opt/android-sdk"
  - PATH: "$ANDROID_HOME/tools/bin:$ANDROID_HOME/platform-tools:$PATH"
